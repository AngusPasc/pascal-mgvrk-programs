program l10_3;
{??????????? ?????? ?????? ??????? ? ??????? ???????????
?????????? ?????????? ????????? ? ?????? ??????.}
uses
crt;
type
matr=array [1..100,1..100] of integer;
stroka=string [100];
mass1=array [1..100] of integer;
var
c,a:matr;
i,j,m,n,x:integer;
b:mass1;

procedure vvodmatr(var a:matr;filename:stroka;var m,n:integer);
var
fin:text;
i,j:integer;
begin
assign(fin,filename);
reset(fin);
readln(fin,n,m);
for i:=1 to n do
begin
for j:=1 to m do
read(fin,a[i,j]);
readln(fin);
end;
close(fin);
end;

procedure vivodmatr(a:matr;filename:stroka;m,n:integer);
var
fin:text;
i,j:integer;
begin
assign(fin,filename);
rewrite(fin);
for i:=1 to m do
begin
for j:=1 to n do
write(fin,a[i,j],' ');
writeln(fin);
end;
close(fin);
end;

procedure matrc4et4ikmass1(a:mass1;m:integer;var b:mass1); {?????? ??????? ??????? ??? 1-??????? ???????(? ??? ?????????? ?????? ???????? ? ????? ???????, ????????????? ?? ???????). ? ????? ???????, ? ?????? ???????, ? ?????????? ?????????.}
var
i,j,x:integer;
begin
for i:=1 to m do
b[i]:=0;
for i:=1 to m do
for j:=i to m do
begin
if a[i]>a[j] then
b[i]:=b[i]+1
else
b[j]:=b[j]+1;
end;
end;

procedure sortirovkamass1(var a:mass1;m:integer);{????????? ?????????? ?????? ? ??????? ????????, ? ??????????? ?????, m ???????? ??????}
var
c,b:mass1;
i,j:integer;
begin
matrc4et4ikmass1(a,m,b);{??????? ?????? ???????}
for i:=1 to m do
c[b[i]]:=a[i];
for i:=1 to m do
a[i]:=c[i];
end;

procedure strTOmass1(a:matr;m,n:integer;var b:mass1);{??????????? ?????? ??????? ? ?????????? ??????. ? ??? ?????????? ????????? ? ??????, ? ??? ????? ??????}
var
i:integer;
begin
for i:=1 to m do
b[i]:=a[n,i];
end;

function MaxRavnElSt(a:matr;m,n:integer):integer;{??????? ???????????? ?????????? ?????????? ????????? ? ?????? ???????. ? ??? ?????????? ????????? ? ??????, ? ??? ????? ??????}
var
b:mass1;
i,tekEl,koll,makskoll:integer;
begin
strTOmass1(a,m,n,b); {??????????? ?????? ? ?????????? ??????}
sortirovkamass1(b,m); {????????? ??????}
tekEl:=b[1];
makskoll:=0;
koll:=0;
for i:=1 to m do
begin
if tekEl=b[i] then
koll:=koll+1
else
begin
koll:=1;
tekEl:=b[i];
end;
if makskoll<koll then
makskoll:=koll;
end;
MaxRavnElSt:=makskoll;
end;

procedure sortirmatr(var a:matr;m,n:integer);
var
c:matr;
b,e:mass1;
i,j:integer;
begin
for i:=1 to n do
e[i]:=MaxRavnElSt(a,m,i);
matrc4et4ikmass1(e,n,b);{??????? ?????? ?? ????????????? ?????????? ?????? ????????? ?????, ????? ??????? ??? ????? ??????? ?????? ???????}
for i:=1 to n do
for j:=1 to m do
c[b[i],j]:=a[i,j];
for i:=1 to n do
for j:=1 to m do
a[i,j]:=c[i,j];
end;

begin
clrscr;
vvodmatr(a,'1013.txt',m,n);
sortirmatr(a,m,n);
vivodmatr(a,'rez.txt',n,m);
readkey;
end.